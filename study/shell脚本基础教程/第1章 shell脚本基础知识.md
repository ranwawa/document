# 第 1 章 shell 脚本基础知识

- [1. 关于 shell](#1-关于-shell)
  - [1.1 什么是 shell](#11-什么是-shell)
  - [1.2 什么是 bash](#12-什么是-bash)
  - [1.3 shell 命令执行过程(fork-exec 模型)](#13-shell-命令执行过程fork-exec-模型)
- [2. 关于 shell 脚本](#2-关于-shell-脚本)
  - [2.1 什么是 shell 脚本](#21-什么是-shell-脚本)
  - [2.2 什么是解释型语言](#22-什么是解释型语言)
- [3. 变量](#3-变量)
  - [3.1 代码换行`\`](#31-代码换行)
  - [3.2 一行执行多条命令`;`](#32-一行执行多条命令)
  - [3.3 注释](#33-注释)
  - [3.4 系统内置的环境变量](#34-系统内置的环境变量)
  - [3.5 位置参数](#35-位置参数)
  - [3.6 特殊参数](#36-特殊参数)
  - [3.7 declare 声明变量](#37-declare-声明变量)
  - [3.8 数组](#38-数组)
  - [3.9 关系数组](#39-关系数组)
- [4. 展开和引用](#4-展开和引用)
- [5. 控制结构](#5-控制结构)

## 1. 关于 shell

### 1.1 什么是 shell

- shell 是命令解释器
- 解析输入的命令,传递给 linux 内核

### 1.2 什么是 bash

- 是 linux 中内置的 shell

### 1.3 shell 命令执行过程(fork-exec 模型)

- shell 主线程通过 fork 系统调用,复制自己创建一个子进程
- 子进程通过 exec 系统调用,将子线程替换成具体的 shell 命令
- shell 主线程通过 wait 系统调用,等待子进程退出
- 子进程退出时执行 exit 系统调用
- 主线程执行下一条命令

## 2. 关于 shell 脚本

### 2.1 什么是 shell 脚本

预先记录 shell 命令的文件就是 shell 脚本

### 2.2 什么是解释型语言

编写之后可以直接执行源代码,不用经过编译操作.

- shell
- vbs

## 3. 变量

### 3.1 代码换行`\`

```bash
echo \
hello,world!
```

### 3.2 一行执行多条命令`;`

```bash
echo hello,world;pwd;ls;
```

### 3.3 注释

```bash
# 整行注释
echo hello,world # 部分注释
```

### 3.4 系统内置的环境变量

| 环境变量     | 含义                                                                              |
| ------------ | --------------------------------------------------------------------------------- |
| HOME         | 当前登录用户的主目录                                                              |
| PWD          | 当前目录                                                                          |
| OLDPWD       | 切换之前的目录                                                                    |
| SHELL        | 当前 shell 的路径                                                                 |
| BASH         | bash 路径                                                                         |
| BASH_VERSION | bash 版本                                                                         |
| LINENO       | 当前脚本执行的行号                                                                |
| LANG         | 国家地区信息                                                                      |
| PATH         | 保存 shell 命令的目录                                                             |
| IFS          | Internal Field Separator 内部字段分隔符,将字符串拆分成单词的时候,会使用这个分隔符 |

### 3.5 位置参数

| 符号      | 含义                    |
| --------- | ----------------------- |
| \$0       | 执行中的 shell 脚本名称 |
| \$1...\$9 | 传进来的前 9 个参数     |
| \${10}... | 第 10 个及以后的参数    |
| \$@       | 所有参数                |
| \$#       | 位置参数个数            |

### 3.6 特殊参数

| 符号 | 含义                        |
| ---- | --------------------------- |
| \$?  | 上条命令的退出状态          |
| \$\$ | 当前进程的进程 ID           |
| \$!  | 最后启动的后台命令的进程 ID |

#### 3.6.1 locale 中各选项的优先级

LC*ALL > LC*\* > LANG

### 3.7 declare 声明变量

```bash
declare -r name
age=27
declare -i age
```

#### 3.7.1 declare 的常用参数

| 参数 | 含义           |
| ---- | -------------- |
| -r   | 只读           |
| -i   | 数值           |
| -a   | 数组           |
| -A   | 关系数组(对象) |

#### 3.7.2 整型变量

一旦变量被声明为整型,赋值时,都会对右边进行数学运算

### 3.8 数组

#### 3.8.1 创建数组

```bash
arry1=(a b c d e)
arry2=()
declare -a arry3
arry4=(a b [8]=c) # 中间的空位就是空串
```

#### 3.8.2 访问数组

```bash
arry=(a b c d e f)
echo ${arry} # 默认下标0 -> a
echo ${arry[1]} # -> b
echo ${arry[@]} # 访问所有元素
echo ${#arry[@]} # 获取元素长度
echo ${!arry[@]} # 获取所有索引
```

#### 3.8.3 删除数组

```bash
arry=(a b c d e f)
unset arry[0]
```

#### 3.8.4 修改数组

```bash
arry=(a b c d e f)
arry[0]=0
arry=(-1 "${arry[@]}")
arry=("${arry[@]}" g)
arry+=(h i)
```

### 3.9 关系数组

除了声明之外,其他和数组一样

```bash
declare -A obj=([name]=ranwawa [age]=18)
obj[sex]=male
echo ${#obj[@]}
```

## 4. 展开和引用

## 5. 控制结构
